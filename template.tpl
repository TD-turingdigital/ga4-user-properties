___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "GA4 User Properties",
  "categories" : ["ANALYTICS", "ATTRIBUTION"],
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/jpeg;base64,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"
  },
  "description": "Setting User Properties of GA4",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "measurementId",
    "displayName": "Measurement ID",
    "simpleValueType": true,
    "alwaysInSummary": true
  },
  {
    "type": "GROUP",
    "name": "defaultPropertiesGroup",
    "displayName": "Default User Properties",
    "subParams": [
      {
        "type": "CHECKBOX",
        "name": "client_id",
        "checkboxText": "client_id",
        "simpleValueType": true,
        "alwaysInSummary": true
      },
      {
        "type": "CHECKBOX",
        "name": "session_id",
        "checkboxText": "session_id",
        "simpleValueType": true,
        "alwaysInSummary": true
      }
    ],
    "groupStyle": "ZIPPY_CLOSED"
  },
  {
    "type": "GROUP",
    "name": "customPropertiesGroup",
    "displayName": "Custom User Properties",
    "groupStyle": "ZIPPY_CLOSED",
    "subParams": [
      {
        "type": "SIMPLE_TABLE",
        "name": "customProperties",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "name",
            "name": "name",
            "type": "TEXT"
          },
          {
            "defaultValue": "",
            "displayName": "value",
            "name": "value",
            "type": "TEXT"
          }
        ],
        "alwaysInSummary": false
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// const log = require('logToConsole');
// log('data =', data);

const createArgumentsQueue = require('createArgumentsQueue');
const gtag = createArgumentsQueue('gtag', 'dataLayer');

let user_properties = {};

if(data.customProperties) {
  user_properties = data.customProperties.reduce((acc, cur) => {
    acc[cur.name] = cur.value;
    return acc;
  }, {});
}

let fields = [];
if(data.client_id) fields.push('client_id');
if(data.session_id) fields.push('session_id');

const gtagSuccess = () => {
  data.gtmOnSuccess();
};
const gtagSet = (user_properties) => {
  gtag('set', 'user_properties', user_properties);
};
const gtagGet = (fields) => {
  if(fields.length) {
    let filed = fields.pop();
    
    gtag('get', data.measurementId, filed, function(value) {
      user_properties[filed] = '(' + value.toString() + ')';
      
      if(fields.length) {
        gtagGet(fields);
      }
      else {
        gtagSet(user_properties);
        gtagSuccess();
      }
    });
  }
};
gtagGet(fields);


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "gtag"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "dataLayer"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 2021/5/17 下午2:55:12


